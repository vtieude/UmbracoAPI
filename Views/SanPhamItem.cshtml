@inherits Umbraco.Web.Mvc.UmbracoTemplatePage<ContentModels.SanPhamItem>
@using ContentModels = Umbraco.Web.PublishedContentModels;
@{
	Layout = "Master.cshtml";
	var currentNode = UmbracoContext.Current.PublishedContentRequest.PublishedContent;
	var homepage= Model.Content.AncestorsOrSelf(1).FirstOrDefault();
}
<div class="w3l_banner_nav_right products-items">
	<div class="products-items-content-page">
		<div class="products-item-header">
			<h3>@(currentNode.GetPropertyValue<string>("pageTittle"))</h3>
		</div>
		<div class="carousel slide article-slide item-products-carousel" id="article-photo-carousel">
		<!-- Wrapper for slides -->
			<div class="carousel-inner cont-slider">
				@{
					if (currentNode.HasValue("Images")){
					var caseStudyImagesList = currentNode.GetPropertyValue<string>("images").Split(new string[] { "," }, StringSplitOptions.RemoveEmptyEntries).Select(int.Parse);
					var caseStudyImagesCollection = Umbraco.TypedMedia(caseStudyImagesList).Where(x => x != null);
					var checkFirstItem = true;
					string active = "";
					foreach (var item in caseStudyImagesCollection)
						{
							active = checkFirstItem? "active": "";
							checkFirstItem = false;
							<div class="item @active">
								<img class="mySlides lazy" data-u="image" data-src="@item.Url" width="600" height="400" />
							</div>
						}
					}
				}
				<!-- <div class="item active">
					<img class="mySlides" src="/images/dogo.jpg" width="600" height="400" />
				</div>
				<div class="item">
					<img class="mySlides" src="/images/dogo.jpg" width="600" height="400"  />
				</div>
				<div class="item">
					<img class="mySlides" src="/images/dogo.jpg" width="600" height="400"  />
				</div>
				<div class="item">
					<img class="mySlides" src="/images/dogo.jpg" width="600" height="400" />
				</div> -->
			</div>
			<!-- Indicators -->
			<ol class="carousel-indicators">
				@{
					if (currentNode.HasValue("Images")){
					var caseStudyImagesList = currentNode.GetPropertyValue<string>("images").Split(new string[] { "," }, StringSplitOptions.RemoveEmptyEntries).Select(int.Parse);
					var caseStudyImagesCollection = Umbraco.TypedMedia(caseStudyImagesList).Where(x => x != null);
					var checkFirstItem = true;
					string active = "";
					int count = 0;
					foreach (var item in caseStudyImagesCollection)
						{
							active = checkFirstItem? "active": "";
							checkFirstItem = false;
							<li class=" @active" data-slide-to="@count" data-target="#article-photo-carousel">
								<img class="mySlides lazy" data-u="image" data-src="@item.Url" width="100%" height="auto" />
							</li>
							count++;
						}
					}
				}
				<!-- <li class="active" data-slide-to="0" data-target="#article-photo-carousel">
					<img class="mySlides" src="/images/dogo.jpg" width="100%" height="auto" />
				</li>
				<li class="" data-slide-to="1" data-target="#article-photo-carousel">
					<img class="mySlides" src="/images/dogo.jpg" width="100%" height="auto"/>
				</li>
				<li class="" data-slide-to="2" data-target="#article-photo-carousel">
					<img class="mySlides" src="/images/dogo.jpg" width="100%" height="auto"/>
				</li>
				<li class="" data-slide-to="3" data-target="#article-photo-carousel">
					<img class="mySlides" src="/images/dogo.jpg" width="100%" height="auto" />
				</li> -->
			</ol>
		</div>
		<div class="items-products-content">
			<div class="items-products-detail">
				<div class="items-header"><p>@(currentNode.GetPropertyValue<string>("moTa"))</p></div>
				<div class="items"><p>Chất liệu: <span class="text">@(currentNode.GetPropertyValue<string>("chatLieu"))</span> </p></div>
				<div class="items"><p>Giá: <span class="text">@(currentNode.GetPropertyValue<string>("gia"))</span></p></div>
				<div class="items"><p>Liên hệ: <span class="text">@(homepage.GetPropertyValue<string>("soDienThoai"))</span></p></div>
			</div>
		</div>
	</div>
	<div class="clear-fix"></div>
	<div class="products-another-items-content-page">
		<h3 class="products-another-header">Các sản phẩm khác</h3>
		<div class="products-another-content">
			<ul >
				@{
					if (currentNode.Parent != null){
						var parent = currentNode.Parent;
						foreach (var item in parent.Children){
							if (item != currentNode) {
								var caseStudyImagesList = item.GetPropertyValue<string>("images").Split(new string[] { "," }, StringSplitOptions.RemoveEmptyEntries).Select(int.Parse);
								var caseStudyImagesCollection = Umbraco.TypedMedia(caseStudyImagesList).Where(x => x != null);
								var image = caseStudyImagesCollection.FirstOrDefault();
								<li class="products-another-items">
									<a href="@item.Url">
										<div class="image-lazy-loading">
											<img class="lazy" data-src="@image.Url"/>
										</div>
										<div class="products-another-items-content">
											<h4>@(item.Name)</h4>
											<div class="prices-item">
												<p>Giá: <span class="text"> @(item.GetPropertyValue<string>("gia"))</span></p>
												</div>
											<div class="type-item"><p>@(item.GetPropertyValue<string>("chatLieu"))</p></div>
										</div>
									</a>
								</li>
							}
						}
					}
				}
			</ul>
		</div>
	</div>
</div>